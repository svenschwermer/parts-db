{{template "pre-content.html" .}}

<div class="container-fluid">
  <div class="alert alert-danger" role="alert" onclick="hide(this)">
    This is an error message!
  </div>

  <table class="table">
    <thead>
      <tr>
        <th scope="col">Part number</th scope="col">
        <th scope="col">Manufacturer</th scope="col">
        <th scope="col">Category</th>
        <th scope="col">Value</th scope="col">
        <th scope="col">Package</th scope="col">
        <th scope="col">Description</th scope="col">
        <th scope="col">Location</th>
        <th scope="col">Inventory</th scope="col">
        <th scope="col">Distributor</th scope="col">
      </tr>
    </thead>
    <tbody>
      {{range .Content}}
      <tr>
        <td><a href="/edit?part={{.PartID}}">{{.PartNumber}}</a></td>
        <td>{{.Manufacturer}}</td>
        <td>{{.Category}}</td>
        <td>{{.Value}}&#8239;{{.UnitPrefix}}{{.Unit}}</td>
        <td>{{.Package}}</td>
        <td>{{.Description}}</td>
        <td>{{.Location}}</td>
        <td class="inventory">
          <span id="inventory_{{.PartID}}">{{.Inventory}}</span>
          <a href="javascript:changeInventory('{{.PartID}}', 1)">▲</a>
          <a href="javascript:changeInventory('{{.PartID}}', -1)">▼</a>
        </td>
        <td>
          {{if .Distributors}}
          <ul>
            {{range .Distributors}}
            <li><a href="{{.URL}}">{{.Name}}</a></li>
            {{end}}
          </ul>
          {{end}}
        </td>
      </tr>
      {{end}}
    </tbody>
  </table>
</div>

<script src="assets/common.js"></script>
<script>
  function changeInventory(partId, delta) {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4) {
        if (this.status == 200)
          document.getElementById("inventory_" + partId).innerText = this.responseText;
        else
          showError("Error: Status " + this.status + ": " + this.statusText);
      }
    };
    xhttp.open("POST", "change-inventory", true);
    xhttp.send(JSON.stringify({ "part": partId, "delta": delta }));
  }
</script>

{{template "post-content.html" .}}
